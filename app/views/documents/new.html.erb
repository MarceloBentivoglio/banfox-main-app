<%= render partial: "shared/header_name_first", locals: {
  title: "que tal deixarmos seu cadastro atualizado?",
  sub_title: "Faça o upload dos arquivos solicitados",
  company_name: @seller.company_name
} %>

<%= render partial: "shared/documents_menu", locals: {menu_in: :new} %>

<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="input-file-box">
        <%= simple_form_for @seller, url: documents_path, method: :post do |f| %>
          <% @uploads.each do |description, upload| %>
            <%= render partial: "document_input", locals: {f: f, description: description, upload: upload} %>
          <% end %>
        <%= f.submit 'Subir arquivos', class: "btn btn-file-upload"%>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
  const inputs = document.querySelectorAll(".inputfile");

  inputs.forEach((input) => {
    input.addEventListener("change", (event) => {
      const input = event.target;
      const infoArea = event.target.parentNode.parentNode.querySelector(".file-status");
      let txt = "";
      if ('files' in input) {
          if (input.files.length === 0) {
              txt = "Selecione um ou mais arquivos";
          } else {
              for (let i = 0; i < input.files.length; i++) {
                  txt += "<li><strong>" + (i+1) + ". </strong>";
                  let file = input.files[i];
                  if ('name' in file) {
                      txt += "<strong>" + file.name + "</strong>";
                  }
                  if ('size' in file) {
                      txt += " | " + file.size + " bytes </li>";
                  }
                  console.log(txt);
              }
          }
      } else {
        if (input.value === "") {
            txt += "Selecione um ou mais arquivos";
        } else {
            txt += "Este tipo de arquivo não é suportado pelo seu navegador! Favor usar o Chrome!";
            txt  += "<br>Informe este código para a MVP: " + input.value;
        }
      }
      infoArea.innerHTML = txt;
    });
  });
</script>

